<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link th:href="@{/static/bootstrap/css/bootstrap.min.css}" rel="stylesheet">

<link rel="stylesheet" th:href="@{/static/bootstrap/css/style.css}" />
<title>车辆列表</title>
</head>
<body  background="/springmvc-05-car/pic/128.jpg">

	<!-- 车辆列表展示 -->
	<h2>车辆列表</h2>
	<div class="container-fluid">
		<div class="row" id="carList">
		</div>
	</div>
	<div style="text-align: center;margin-left:auto">
		<button type="button" class="btn btn-primary" id="firstPage">首页</button>
		<button type="button" class="btn btn-success" id="prePage">上一页</button>
		<button type="button" class="btn btn-danger" id="nextPage">下一页</button>
		<button type="button" class="btn btn-warning" id="lastPage">尾页</button>
	</div>

<script th:src="@{/static/js/jquery/jquery.min.js}"
		type="text/javascript"></script>
	<script th:src="@{/static/bootstrap/js/bootstrap.min.js}"
		type="text/javascript"></script>
	<script
		th:src="@{/static/bootstrap/js/validate/jquery.validate.min.js}"
		type="text/javascript"></script>
	<script th:src="@{/static/bootstrap/js/validate/messages_zh.min.js}"
		type="text/javascript"></script>

<script th:inline="javascript" type="text/javascript">
	const path = /*[[${#request.getContextPath()}]]*/
	
	
	$(function(){
		et1911.queryList();
		
		$('#firstPage').click(function(){
			et1911.queryList();
		})
		$('#nextPage').click(function(){
			et1911.queryList(++currentPage);
		})
		$('#prePage').click(function(){
			et1911.queryList(--currentPage);
		})
		$('#lastPage').click(function(){
			et1911.queryList(pageCount);
		})
	})
	let currentPage=1;
	let pageCount;


	
	let et1911 = {
			
			queryList: function(pageNum,pageSize){
				
				//如果pageNum,pageSize不传(或者传入'',Undefined),这时就取后面的数值
				pageNum = pageNum || 1
				pageSize = pageSize || 8
				
				$.ajax({
					url: path + '/car/list',
					type: 'GET',
					data: 'pageNum=' + pageNum + '&pageSize=' + pageSize,
					dataType:'json',
					success: function(res){
						//当前页
						currentPage = res.pageNum
						
						//总页数
						pageCount = res.pageCount
						
						
						let divs = '';
						$.each(res.rows,function(index,car){
							/* divs += "<div class='col-md-3'>"
									+ "<img class='img-thumbnail' src='" + path + car.pic + "' style='width: 550px;height: 350px'>"
									+ "</div>" */
							divs+=`
                            	<div class="col-sm-6 col-md-3">
                                <div class="thumbnail" >
                                	<img src="${path+car.pic}" style="width: 550px;height: 350px">
                                    <div class="caption" style="background-color: #A6A6A6" >
                                    	<h3  style="font-weight: 600;margin-left: 35px;">${car.brand} /
                                    	${car.series} /${car.gearboxName}</h3>
                                    	<h3 style="margin-left: 35px;">${car.licensingTime}上牌|${car.mileage}万公里</h3>
	                                    <h3 style="color: #ff0000; margin-left: 35px;">价格:${car.price}万元</h3>
	                                    <h4 style="margin-left: 35px;color:#FFF000">${car.location}</h4>
	                                    <h4 style="font-weight: 600;margin-left: 35px;">${car.summary}</h4>
                                  </div>
                                </div>
                              </div> `
						})
						$('#carList').html(divs)
						
						//如果是第一页,把上一页和首页禁用
						if(res.first){
							$('#firstPage').attr('disabled','disabled')
							$('#prePage').attr('disabled','disabled')
						}else{
							$('#firstPage').removeAttr('disabled')
							$('#prePage').removeAttr('disabled')
						}
						
						//如果是最后一页,把尾页和下一页禁用
						if(res.last){
							$('#lasttPage').attr('disabled','disabled')
							$('#nextPage').attr('disabled','disabled')
						}else{
							$('#lastPage').removeAttr('disabled')
							$('#nextPage').removeAttr('disabled')
						}
					}
				});
			}
	}
	
</script>
</body>
</html>